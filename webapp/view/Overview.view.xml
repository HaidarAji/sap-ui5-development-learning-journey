<mvc:View controllerName="sap.training.exc.controller.Overview"
          xmlns="sap.ui.table"
          xmlns:mvc="sap.ui.core.mvc"  
          xmlns:f="sap.ui.layout.form"
          xmlns:core="sap.ui.core"
          xmlns:m="sap.m"
          core:require="{formatter: 'sap/training/exc/model/formatter'}">
    <m:Page title="Flight Customers">
        <m:content>
            <m:Panel expandable="{= !${device>/system/desktop} }" expanded="{device>/system/desktop}"
            headerText="New Customer"
            class="sapUiResponsiveMargin sapUiHideOnPhone" width="auto">
                <m:content>
                    <f:SimpleForm layout="ColumnLayout" editable="true">
                        <f:toolbar>
                            <m:Toolbar>
                                <m:content>
                                    <m:ToolbarSpacer/>
                                    <m:Button icon="sap-icon://create" text="Create Customer" press=".onSave"
                                    enabled="{= ${customer>/CustomerName} !== undefined &amp;&amp; ${customer>/CustomerName}.length > 0 }"/>
                                </m:content>
                            </m:Toolbar>
                        </f:toolbar>
                        <f:content>
                            <core:Title text="General Data"/>
                            <m:Label text="Form"/>
                            <m:Input value="{customer>/Form}"/>
                            <m:Label text="Customer Name"/>
                            <m:Input value="{customer>/CustomerName}" valueLiveUpdate="true"/>
                            <m:Label text="Discount"/>
                            <m:Input value="{ path: 'customer>/Discount',
                                type: 'sap.ui.model.type.Integer',
                                constraints: {minimum: 0, maximum: 100} }"/>
                            <core:Title text="Address Data"/>
                            <m:Label text="Street"/>
                            <m:Input value="{customer>/Street}"/>
                            <m:Label text="Post Code"/>
                            <m:Input value="{customer>/PostCode}"/>
                            <m:Label text="City"/>
                            <m:Input value="{customer>/City}"/>
                            <m:Label text="Country"/>
                            <m:Input value="{customer>/Country}"/> 
                            <core:Title text="Contact Data"/>
                            <m:Label text="Email"/>    
                            <m:Input value="{customer>/Email}"/>
                            <m:Label text="Telephone"/>
                            <m:Input value="{customer>/Telephone}"/>
                        </f:content>
                    </f:SimpleForm>
                </m:content>
            </m:Panel>
            <Table 
                id="customerTable"
                rows="{/Customers}"
                sort="sortCustomers"
                selectionMode="Single"
                cellClick=".onCellClick"
                >
                <columns>
                    <Column 
                        id="name"
                        width="11rem"
                        sortProperty="CustomerName">
                        <m:Label text="Customer Name"></m:Label>
                        <template>
                            <!-- <m:Text text="{CustomerName}" wrapping="false"></m:Text> -->
                            <m:Input value="{CustomerName}" editable="true"/>
                        </template>
                    </Column>
                    <Column 
                        id="city"
                        width="11rem"
                        sortProperty="City">
                        <m:Label text="City"></m:Label>
                        <template>
                            <m:Text text="{City}" wrapping="false"></m:Text>
                        </template>
                    </Column>
                    <Column 
                        id="country"
                        width="11rem"
                        sortProperty="Country">
                        <m:Label text="Country"></m:Label>
                        <template>
                            <m:Text text="{Country}" wrapping="false"></m:Text>
                        </template>
                    </Column>
                    <Column 
                        id="email"
                        width="11rem"
                        sortProperty="Email">
                        <m:Label text="Email"></m:Label>
                        <template>
                            <m:Text text="{Email}" wrapping="false"></m:Text>
                        </template>
                    </Column>
                </columns>
            </Table> 
            <m:Table id="bookingTable" headerText="Bookings" items="{_Bookings}"
            growing="true" growingThreshold="5" class="sapUiResponsiveMargin" width="auto">
                <m:columns>
                    <m:Column><m:header><m:Text text="Airline ID"></m:Text></m:header></m:Column>
                    <m:Column><m:header><m:Text text="Connection Number"></m:Text></m:header></m:Column>
                    <m:Column><m:header><m:Text text="Flight Date"></m:Text></m:header></m:Column>
                    <m:Column minScreenWidth="Desktop"
                        demandPopin="true"><m:header><m:Text text="Class"></m:Text></m:header></m:Column>
                    <m:Column minScreenWidth="Tablet"
                        demandPopin="true"><m:header><m:Text text="Foreign Currency Payment"></m:Text></m:header></m:Column>
                    <m:Column minScreenWidth="Tablet"
                        demandPopin="true"><m:header><m:Text text="Cancellation Status"></m:Text></m:header></m:Column>
                </m:columns>
                <m:items>
                    <m:ColumnListItem>
                        <m:cells>
                            <m:ObjectIdentifier title="{AirlineID}"></m:ObjectIdentifier>
                            <m:ObjectIdentifier title="{ConnectionNumber}"></m:ObjectIdentifier>
                            <m:ObjectIdentifier title="{
                                path: 'FlightDate',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: {
                                    source: {pattern: 'yyyy-MM-dd'},
                                    style: 'medium'
                                }
                            }"/>
                            <m:Text text="{
                                path: 'Class',
                                formatter: 'formatter.classText'
                            }"/>
                            <m:ObjectNumber number="{
                                parts: [
                                    {path: 'ForeignCurrencyPayment'},
                                    {path: 'ForeignCurrency'}
                                ],
                                type: 'sap.ui.model.type.Currency',
                                formatOptions: {showMeasure: false}
                            }"
                            unit="{ForeignCurrency}"/>
                            <!-- <m:Text text="{IsCancelled}"></m:Text> -->
                            <core:Icon src="{= ${IsCancelled} === 'X' ? 'sap-icon://cancel' : 'sap-icon://accept' }"
                            tooltip="{= ${IsCancelled} === 'X' ? 'cancelled' : 'not cancelled' }"/>
                        </m:cells>
                    </m:ColumnListItem>
                </m:items>
            </m:Table>
        </m:content>
    </m:Page>
</mvc:View>